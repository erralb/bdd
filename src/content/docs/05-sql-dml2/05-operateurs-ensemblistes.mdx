---
title: Opérateurs ensemblistes
---


# Les opérateurs ensemblistes

* Un ensemble est une collection d'éléments  __distincts__
  * Un ensemble de lignes ne peut donc contenir 2 lignes dont les attributs, considérés 2 à 2, ont la même valeur
* Une collection de lignes dont les éléments ne sont pas distincts constitue un multi-ensemble
  * Une requête dont la liste d'éléments de la clause SELECT n'inclut pas tous les éléments d'un identifiant renvoie un multi-ensemble
  * Un multi-ensemble peut se réduire si nécessaire à un ensemble par le modifieur DISTINCT


---


L'opérateur UNION produit une collection de lignes distinctes à partir d'un ensemble de 2 collections de lignes

Si une même ligne apparaît dans chacune des 2 collections de lignes en argument de l'opérateur UNION, cette ligne n'apparaîtra qu'une seule fois dans l'ensemble résultat

Remarque : Les arguments de l'opérateur UNION peuvent être des multi-ensembles, auxquels cas les doublons sont égalements éliminés


---


Soit la requête suivante :

```
__SELECT__  LOCALITE  __FROM__  CLIENT  __WHERE__  CAT = 'C1' ;

```
avec la suivante qui lui ajoute des éléments :

```
__SELECT__  LOCALITE  __FROM__  CLIENT  __WHERE__  CAT = 'C1' __UNION__  __SELECT__  LOCALITE  __FROM__  CLIENT  __WHERE__  COMPTE <0;

```
le résultat produit est le suivant :

![](CM4%20-%20Le%20langage%20SQL%20DML%20-%20Les%20Jointures5.png)


---


* Si l'on désire empêcher l'élimination des lignes en double, on utilisera l'opérateur UNION ALL
  * Une même ligne qui apparaît n1 fois dans le premier membre et n2 fois dans le second apparaîtra n1 + n2 dans le résultat, comme le montre la requête suivante :
```
* __SELECT__  LOCALITE  __FROM__  CLIENT  __WHERE__  CAT = 'C1' __UNION__   __ALL__  __SELECT__  LOCALITE  __FROM__  CLIENT  __WHERE__  COMPTE <0;

```
  * le résultat de la requête est le suivant :

![](CM4%20-%20Le%20langage%20SQL%20DML%20-%20Les%20Jointures6.png)


---


* Les opérateurs d'intersection (INTERSECT) et de différence (EXCEPT) fonctionne de manière similaire à l'opérateur UNION
  * L'opérateur INTERSECT construit l'ensemble des éléments simultanément présents dans deux collections
  * L'opérateur EXCEPT construit l'ensemble des éléments appartenant à la première collection mais pas à la seconde
* Remarque : Munis de la clause ALL, ces opérateurs préservent les lignes en doubles. Pour une même ligne respectivement en n1 et n2 exemplaires dans chaque argument :
  * INTERSECT ALL produira  _min(n1, n2)_  exemplaires de cette ligne
  * EXCEPT ALL produira  _max(n1 - n2, 0)_  exemplaires de cette ligne


---


* Les opérateurs d'intersection et de différence entre deux ensembles de lignes ne sont pas strictement indispensables dans la mesure ou ils peuvent être exprimés par des requête standards :
  * L'intersection ensembliste de 2 tables est obtenue par leur jointure, car celle-ci reprend les éléments qui sont simultanément présents dans ces tables
  * La différence ensembliste s'exprimera par le prédicat NOT IN dont la sous-requête définit les éléments de la seconde collection


---

